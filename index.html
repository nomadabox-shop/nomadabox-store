<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NOMADABOX | Future Shopping</title>
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;700;900&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['Outfit', 'sans-serif'] },
                    colors: {
                        lime: {
                            400: '#a3e635',
                            500: '#84cc16', // Tu Verde Manzana
                            600: '#65a30d',
                        },
                        dark: '#0f172a'
                    },
                    animation: {
                        'blob': 'blob 7s infinite',
                        'float': 'float 6s ease-in-out infinite',
                        'shimmer': 'shimmer 2s linear infinite',
                    },
                    keyframes: {
                        blob: {
                            '0%': { transform: 'translate(0px, 0px) scale(1)' },
                            '33%': { transform: 'translate(30px, -50px) scale(1.1)' },
                            '66%': { transform: 'translate(-20px, 20px) scale(0.9)' },
                            '100%': { transform: 'translate(0px, 0px) scale(1)' },
                        },
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-20px)' },
                        }
                    }
                }
            }
        }
    </script>
    <style>
        /* Estilos base */
        body { 
            background-color: #f0f2f5; 
            overflow-x: hidden;
        }
        
        /* Glassmorphism Classes */
        .glass-panel {
            background: rgba(255, 255, 255, 0.65);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.5);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.07);
        }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.4);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.6);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .glass-card:hover {
            background: rgba(255, 255, 255, 0.7);
            border-color: #84cc16;
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 20px 40px -10px rgba(132, 204, 22, 0.3);
        }

        .text-gradient {
            background: linear-gradient(135deg, #1a1a1a 0%, #4d4d4d 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .btn-primary {
            background: linear-gradient(135deg, #84cc16 0%, #65a30d 100%);
            box-shadow: 0 4px 15px rgba(132, 204, 22, 0.4);
        }

        /* Ocultar scrollbar pero permitir scroll */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    </style>
</head>
<body class="antialiased text-slate-800">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- CONSTANTES ---
        const SHEET_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQMwxXL0sZMSK-AVLVWjKuC8SW4s5IAUzescfV7F3i-25dwed9dz0IXF0Qydja1x4mzxmHvwO4B7I84/pub?gid=0&single=true&output=csv";
        const WHATSAPP = "59895736428"; 

        // --- COMPONENTES VISUALES ---

        // Fondo animado con "blobs" de color
        const AnimatedBackground = () => (
            <div className="fixed inset-0 -z-10 overflow-hidden pointer-events-none">
                <div className="absolute top-0 left-1/4 w-96 h-96 bg-lime-400 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-blob"></div>
                <div className="absolute top-0 right-1/4 w-96 h-96 bg-emerald-300 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-blob animation-delay-2000"></div>
                <div className="absolute -bottom-32 left-1/3 w-96 h-96 bg-lime-200 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-blob animation-delay-4000"></div>
                <div className="absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-20"></div>
            </div>
        );

        const Navbar = ({ cartCount, onOpenCart }) => (
            <nav className="fixed top-0 w-full z-50 transition-all duration-300">
                <div className="glass-panel mx-4 mt-4 rounded-2xl px-6 py-4 flex justify-between items-center shadow-lg">
                    <div className="flex items-center gap-3">
                        <div className="w-10 h-10 rounded-xl bg-gradient-to-tr from-lime-500 to-lime-400 flex items-center justify-center text-white font-black text-xl shadow-lime-500/50 shadow-lg">
                            N
                        </div>
                        <h1 className="text-2xl font-black tracking-tighter text-slate-800">
                            NOMADA<span className="text-lime-600">BOX</span>
                        </h1>
                    </div>

                    <div className="flex items-center gap-4">
                        <span className="hidden md:block text-xs font-bold bg-white/50 px-3 py-1 rounded-full border border-white/60 text-slate-500">
                            üöö ENV√çO INCLUIDO SIEMPRE
                        </span>
                        <button 
                            onClick={onOpenCart} 
                            className="relative w-12 h-12 rounded-xl bg-white border border-white flex items-center justify-center shadow-sm hover:shadow-md transition-all group"
                        >
                            <i className="ph ph-shopping-bag text-2xl text-slate-700 group-hover:text-lime-600 transition-colors"></i>
                            {cartCount > 0 && (
                                <span className="absolute -top-2 -right-2 w-6 h-6 bg-lime-500 text-white text-xs font-bold rounded-full flex items-center justify-center shadow-lg animate-bounce border-2 border-white">
                                    {cartCount}
                                </span>
                            )}
                        </button>
                    </div>
                </div>
            </nav>
        );

        const Hero = () => (
            <header className="pt-40 pb-20 px-4 container mx-auto text-center relative">
                <div className="inline-flex items-center gap-2 px-4 py-2 rounded-full glass-panel mb-8 animate-float">
                    <span className="w-2 h-2 rounded-full bg-lime-500 animate-pulse"></span>
                    <span className="text-xs font-bold uppercase tracking-widest text-slate-500">La nueva forma de comprar</span>
                </div>
                
                <h2 className="text-5xl md:text-8xl font-black mb-6 tracking-tight leading-none text-slate-800">
                    Tu mundo,<br/>
                    <span className="text-transparent bg-clip-text bg-gradient-to-r from-lime-500 to-emerald-600">puesto en casa.</span>
                </h2>
                
                <p className="text-xl md:text-2xl text-slate-500 max-w-2xl mx-auto mb-10 font-light">
                    Todo lo que necesitas, en la caja que te sigue. Sin sorpresas, sin costos ocultos.
                </p>

                <div className="grid grid-cols-1 md:grid-cols-3 gap-4 max-w-5xl mx-auto">
                    {[
                        { t: "Misi√≥n", d: "Hogar y tecnolog√≠a accesible para cada uruguayo.", i: "ph-house-line" },
                        { t: "Visi√≥n", d: "Referente en rapidez y transparencia de precios.", i: "ph-eye" },
                        { t: "Valores", d: "Claridad radical, agilidad n√≥mada e ingenio.", i: "ph-diamond" }
                    ].map((item, idx) => (
                        <div key={idx} className="glass-panel p-6 rounded-3xl text-left hover:bg-white/80 transition-colors">
                            <div className="w-12 h-12 rounded-2xl bg-lime-100 text-lime-600 flex items-center justify-center text-2xl mb-4">
                                <i className={`ph ${item.i}`}></i>
                            </div>
                            <h3 className="font-bold text-lg text-slate-800 mb-1">{item.t}</h3>
                            <p className="text-sm text-slate-500 leading-relaxed">{item.d}</p>
                        </div>
                    ))}
                </div>
            </header>
        );

        const ProductCard = ({ product, onAdd }) => (
            <div className="glass-card rounded-[2rem] p-4 flex flex-col h-full relative group overflow-hidden">
                {/* Etiqueta de Categor√≠a Flotante */}
                <div className="absolute top-6 left-6 z-10">
                    <span className="px-3 py-1 bg-white/90 backdrop-blur rounded-lg text-xs font-bold text-slate-600 shadow-sm border border-white/50">
                        {product.categoria}
                    </span>
                </div>

                {/* Imagen con efecto Zoom */}
                <div className="relative h-64 mb-5 rounded-[1.5rem] overflow-hidden bg-white">
                    <img 
                        src={product.imagen} 
                        alt={product.nombre} 
                        className="w-full h-full object-contain p-4 group-hover:scale-110 transition-transform duration-700 ease-in-out"
                        onError={(e) => {
                            e.target.src = 'https://placehold.co/400x400/f1f5f9/94a3b8?text=Sin+Imagen';
                            e.target.style.objectFit = 'cover';
                        }}
                    />
                </div>
                
                <div className="flex flex-col flex-grow">
                    <h3 className="text-xl font-bold text-slate-800 mb-2 leading-tight">{product.nombre}</h3>
                    <p className="text-sm text-slate-500 mb-4 line-clamp-2 font-light">{product.descripcion}</p>
                    
                    <div className="mt-auto flex items-end justify-between">
                        <div>
                            <span className="text-xs font-semibold text-lime-600 uppercase tracking-wider block mb-1">Precio Final</span>
                            <span className="text-3xl font-black text-slate-800 tracking-tight">$U {parseInt(product.precio).toLocaleString('es-UY')}</span>
                        </div>
                        <button 
                            onClick={() => onAdd(product)}
                            className="w-14 h-14 rounded-2xl btn-primary text-white flex items-center justify-center hover:scale-110 active:scale-95 transition-all duration-300"
                        >
                            <i className="ph ph-plus text-2xl font-bold"></i>
                        </button>
                    </div>
                </div>
            </div>
        );

        const CartSidebar = ({ isOpen, onClose, cart, updateQty, total, onCheckout }) => (
            <>
                <div 
                    className={`fixed inset-0 bg-slate-900/60 backdrop-blur-sm z-[60] transition-opacity duration-500 ${isOpen ? 'opacity-100' : 'opacity-0 pointer-events-none'}`}
                    onClick={onClose}
                />
                <div className={`fixed top-0 right-0 h-full w-full max-w-md bg-white/90 backdrop-blur-xl z-[70] shadow-2xl transform transition-transform duration-500 cubic-bezier(0.16, 1, 0.3, 1) ${isOpen ? 'translate-x-0' : 'translate-x-full'} flex flex-col border-l border-white/50`}>
                    <div className="p-8 pb-4 flex justify-between items-center">
                        <h2 className="text-3xl font-black text-slate-800">Tu Caja</h2>
                        <button onClick={onClose} className="w-10 h-10 rounded-full bg-slate-100 hover:bg-slate-200 flex items-center justify-center transition-colors"><i className="ph ph-x text-xl"></i></button>
                    </div>

                    <div className="flex-1 overflow-y-auto p-8 space-y-6 no-scrollbar">
                        {cart.length === 0 ? (
                            <div className="flex flex-col items-center justify-center h-full text-slate-400 opacity-60">
                                <i className="ph ph-cube text-8xl mb-4"></i>
                                <p className="font-medium">Tu caja n√≥mada est√° vac√≠a</p>
                            </div>
                        ) : (
                            cart.map(item => (
                                <div key={item.id} className="flex gap-4 items-center">
                                    <div className="w-20 h-20 bg-white rounded-2xl shadow-sm p-2 border border-slate-100 flex-shrink-0">
                                        <img src={item.imagen} className="w-full h-full object-contain" />
                                    </div>
                                    <div className="flex-1">
                                        <h4 className="font-bold text-slate-800 leading-tight mb-1">{item.nombre}</h4>
                                        <p className="text-lime-600 font-bold">$U {(item.precio * item.cantidad).toLocaleString('es-UY')}</p>
                                    </div>
                                    <div className="flex flex-col items-center gap-1 bg-slate-100 rounded-lg p-1">
                                        <button onClick={() => updateQty(item.id, 1)} className="w-6 h-6 flex items-center justify-center hover:text-lime-600"><i className="ph ph-plus-circle"></i></button>
                                        <span className="text-xs font-bold">{item.cantidad}</span>
                                        <button onClick={() => updateQty(item.id, -1)} className="w-6 h-6 flex items-center justify-center hover:text-red-500"><i className="ph ph-minus-circle"></i></button>
                                    </div>
                                </div>
                            ))
                        )}
                    </div>

                    <div className="p-8 bg-white border-t border-slate-100">
                        <div className="flex justify-between items-end mb-6">
                            <span className="text-sm text-slate-500 font-medium">Total Final (Env√≠o Inc.)</span>
                            <span className="text-4xl font-black text-slate-800">$U {total.toLocaleString('es-UY')}</span>
                        </div>
                        <button 
                            onClick={onCheckout}
                            disabled={cart.length === 0}
                            className="w-full py-5 rounded-2xl btn-primary text-white font-bold text-lg shadow-xl shadow-lime-500/30 hover:shadow-lime-500/50 transition-all disabled:opacity-50 disabled:shadow-none flex items-center justify-center gap-3"
                        >
                            <span>Procesar Pedido</span>
                            <i className="ph ph-arrow-right font-bold"></i>
                        </button>
                    </div>
                </div>
            </>
        );

        const CheckoutModal = ({ isOpen, onClose, cart, total }) => {
            if (!isOpen) return null;
            const [data, setData] = useState({ name: '', id: '', address: '', phone: '' });

            const sendOrder = (e) => {
                e.preventDefault();
                let msg = `üöÄ *NUEVO PEDIDO NOMADABOX*\n\n`;
                cart.forEach(i => msg += `üì¶ ${i.cantidad}x ${i.nombre}\n`);
                msg += `\nüí∞ *TOTAL A PAGAR: $U ${total.toLocaleString('es-UY')}*\n(Env√≠o Incluido)\n\n`;
                msg += `üìç *Datos de Env√≠o:*\nüë§ ${data.name}\nüÜî ${data.id}\nüè† ${data.address}\nüì± ${data.phone}\n\nüìù Quedo a la espera de la cuenta para transferir.`;
                window.open(`https://wa.me/${WHATSAPP}?text=${encodeURIComponent(msg)}`, '_blank');
                onClose();
            };

            return (
                <div className="fixed inset-0 z-[80] flex items-center justify-center p-4">
                    <div className="absolute inset-0 bg-slate-900/40 backdrop-blur-md" onClick={onClose}></div>
                    <div className="bg-white w-full max-w-lg rounded-[2rem] p-8 relative z-10 shadow-2xl animate-blob">
                        <div className="flex justify-between items-center mb-8">
                            <h3 className="text-2xl font-black text-slate-800">Finalizar Compra</h3>
                            <button onClick={onClose} className="text-slate-400 hover:text-red-500"><i className="ph ph-x-circle text-3xl"></i></button>
                        </div>
                        
                        <form onSubmit={sendOrder} className="space-y-5">
                            <div className="space-y-2">
                                <label className="text-xs font-bold uppercase text-slate-400 tracking-wider">Tu Nombre</label>
                                <input required type="text" className="w-full bg-slate-50 border-none rounded-xl p-4 font-semibold focus:ring-2 focus:ring-lime-500 transition-all" placeholder="Juan P√©rez" onChange={e => setData({...data, name: e.target.value})} />
                            </div>
                            <div className="grid grid-cols-2 gap-4">
                                <div className="space-y-2">
                                    <label className="text-xs font-bold uppercase text-slate-400 tracking-wider">C√©dula</label>
                                    <input required type="text" className="w-full bg-slate-50 border-none rounded-xl p-4 font-semibold focus:ring-2 focus:ring-lime-500 transition-all" placeholder="1.234.567-8" onChange={e => setData({...data, id: e.target.value})} />
                                </div>
                                <div className="space-y-2">
                                    <label className="text-xs font-bold uppercase text-slate-400 tracking-wider">Celular</label>
                                    <input required type="tel" className="w-full bg-slate-50 border-none rounded-xl p-4 font-semibold focus:ring-2 focus:ring-lime-500 transition-all" placeholder="099..." onChange={e => setData({...data, phone: e.target.value})} />
                                </div>
                            </div>
                            <div className="space-y-2">
                                <label className="text-xs font-bold uppercase text-slate-400 tracking-wider">Direcci√≥n de Entrega</label>
                                <textarea required rows="2" className="w-full bg-slate-50 border-none rounded-xl p-4 font-semibold focus:ring-2 focus:ring-lime-500 transition-all" placeholder="Calle, N√∫mero, Apto, Ciudad..." onChange={e => setData({...data, address: e.target.value})}></textarea>
                            </div>
                            
                            <button type="submit" className="w-full py-5 rounded-2xl bg-[#25D366] hover:bg-[#20bd5a] text-white font-bold text-lg shadow-lg hover:shadow-xl transition-all flex items-center justify-center gap-3 transform hover:-translate-y-1">
                                <i className="ph ph-whatsapp-logo text-2xl"></i>
                                Confirmar en WhatsApp
                            </button>
                        </form>
                    </div>
                </div>
            );
        };

        const Footer = () => (
            <footer className="mt-20 py-10 bg-white/50 backdrop-blur border-t border-white/50 text-center">
                <div className="container mx-auto px-4">
                    <h2 className="text-2xl font-black text-slate-800 mb-2">NOMADA<span className="text-lime-600">BOX</span></h2>
                    <p className="text-slate-500 text-sm mb-6">Montevideo, Uruguay ‚Ä¢ Env√≠os a todo el pa√≠s</p>
                    <div className="flex justify-center gap-4 text-slate-400">
                        <i className="ph ph-instagram-logo text-2xl hover:text-lime-600 transition-colors cursor-pointer"></i>
                        <i className="ph ph-facebook-logo text-2xl hover:text-lime-600 transition-colors cursor-pointer"></i>
                    </div>
                    <p className="text-xs text-slate-300 mt-8">¬© 2026 NomadaBox Inc.</p>
                </div>
            </footer>
        );

        // --- APP MAIN ---
        const App = () => {
            const [products, setProducts] = useState([]);
            const [cart, setCart] = useState([]);
            const [isCartOpen, setIsCartOpen] = useState(false);
            const [isCheckoutOpen, setIsCheckoutOpen] = useState(false);
            const [loading, setLoading] = useState(true);

            useEffect(() => {
                Papa.parse(SHEET_URL, {
                    download: true,
                    header: true,
                    complete: (results) => {
                        const cleanData = results.data
                            .filter(i => i.nombre && i.precio) // Filtrar filas vac√≠as
                            .map(i => ({...i, id: i.id || Math.random(), precio: Number(i.precio)}));
                        setProducts(cleanData);
                        setLoading(false);
                    },
                    error: (err) => {
                        console.error("Error CSV:", err);
                        setLoading(false);
                    }
                });

                const savedCart = JSON.parse(localStorage.getItem('nomadabox_cart') || '[]');
                setCart(savedCart);
            }, []);

            useEffect(() => {
                localStorage.setItem('nomadabox_cart', JSON.stringify(cart));
            }, [cart]);

            const addToCart = (product) => {
                setCart(prev => {
                    const exists = prev.find(p => p.id === product.id);
                    if (exists) return prev.map(p => p.id === product.id ? {...p, cantidad: p.cantidad + 1} : p);
                    return [...prev, {...product, cantidad: 1}];
                });
                setIsCartOpen(true);
            };

            const updateQty = (id, n) => {
                setCart(prev => prev.map(p => {
                    if (p.id === id) return {...p, cantidad: Math.max(0, p.cantidad + n)};
                    return p;
                }).filter(p => p.cantidad > 0));
            };

            const total = cart.reduce((acc, el) => acc + (el.precio * el.cantidad), 0);
            const count = cart.reduce((acc, el) => acc + el.cantidad, 0);

            return (
                <div className="min-h-screen relative font-sans text-slate-800">
                    <AnimatedBackground />
                    <Navbar cartCount={count} onOpenCart={() => setIsCartOpen(true)} />
                    <Hero />
                    
                    <main className="container mx-auto px-4 relative z-10">
                        {loading ? (
                            <div className="flex justify-center py-20">
                                <div className="w-16 h-16 border-4 border-lime-200 border-t-lime-500 rounded-full animate-spin"></div>
                            </div>
                        ) : (
                            <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8">
                                {products.map(p => (
                                    <ProductCard key={p.id} product={p} onAdd={addToCart} />
                                ))}
                            </div>
                        )}
                    </main>

                    <Footer />
                    
                    <CartSidebar 
                        isOpen={isCartOpen} 
                        onClose={() => setIsCartOpen(false)} 
                        cart={cart} 
                        updateQty={updateQty} 
                        total={total}
                        onCheckout={() => { setIsCartOpen(false); setIsCheckoutOpen(true); }}
                    />
                    
                    <CheckoutModal 
                        isOpen={isCheckoutOpen} 
                        onClose={() => setIsCheckoutOpen(false)} 
                        cart={cart} 
                        total={total} 
                    />
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
